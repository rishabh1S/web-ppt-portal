<div *ngIf="selectedSlide; else noSlide" class="relative aspect-video rounded-md shadow-lg bg-white">
    <div *ngFor="let element of selectedSlide.elements">
        <ng-container [ngSwitch]="element.type">
            <div *ngSwitchCase="'TEXT'" class="absolute" [ngStyle]="{
           'left.%': element.x, 
           'top.%': element.y, 
           'width.%': element.width, 
           'height.%': element.height
         }">
                <quill-editor [(ngModel)]="element.content" [modules]="quillModules"
                    (onSelectionChanged)="onSelectionChanged($event)"
                    (onEditorCreated)="setEditorFontSize($event, element.style.fontSize)" placeholder="Enter text"
                    class="w-full h-auto" [applyStyles]="element.style">
                </quill-editor>
            </div>
            <div *ngSwitchCase="'IMAGE'" class="absolute" [ngStyle]="{
           'left.%': element.x, 
           'top.%': element.y, 
           'width.%': element.width, 
           'height.%': element.height
         }">
                <img [src]="element.content" alt="Slide Image" class="object-contain w-full h-full" />
            </div>

            <div *ngSwitchCase="'SHAPE'">
                <svg [attr.width]="element.width + '%'" [attr.height]="element.height + '%'" class="absolute"
                    [ngStyle]="{ 'left.%': element.x, 'top.%': element.y }" viewBox="0 0 100 100"
                    preserveAspectRatio="none">
                    <path [attr.d]="element.content" [attr.fill]="element.style.fillColor"
                        [attr.stroke]="element.style.strokeColor" [attr.stroke-width]="element.style.strokeWidth" />
                </svg>
            </div>

            <div *ngSwitchCase="'TABLE'" class="absolute" [ngStyle]="{
                'left.%': element.x, 
                'top.%': element.y, 
                'width.%': element.width, 
                'height.%': element.height
            }">
                <table class="w-full h-full border-collapse">
                    <tr *ngFor="let row of getTableContent(element); let i = index">
                        <td *ngFor="let cell of row; let j = index" [applyStyles]="getTableCellStyle(element, i, j)">
                            {{ cell }}
                        </td>
                    </tr>
                </table>
            </div>
        </ng-container>
    </div>
</div>

<ng-template #noSlide>
    <div class="bg-background aspect-video rounded-md shadow-lg flex items-center justify-center bg-white">
        <p class="text-lg text-gray-600">Select a slide to edit.</p>
    </div>
</ng-template>